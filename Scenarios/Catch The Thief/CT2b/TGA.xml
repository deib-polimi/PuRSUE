	<nta>
	<declaration>
	//events
	//movements 
	broadcast chan police_a2b, police_b2a, police_b2c, police_c2b, police_c2d, police_d2c, police_d2a, police_a2d, police_weaponCloset2a, police_a2weaponCloset, thief_a2b, thief_b2a, thief_b2c, thief_c2b, thief_c2d, thief_d2c, thief_d2a, thief_a2d, thief_weaponCloset2a, thief_a2weaponCloset ;
	//actions
	broadcast chan catch, pickUpBaton, pickUpBatonDONE , putDownBaton, putDownBatonDONE ;
	
	//assuzione che initial state per ogni rule è sempre a index zero quandi si crea, dovrebbe essere coso
	//nota concettuale importante: mentre per le posizioni uso come sono ordinate nella definizione, erl e regole uso come le ordino io nel crearle
	//Agents
	//nota: rule and agents can't have the same name
	clock Cpolice, Cthief;
	//tutte le volta che si prendono gli indici delle location, si shiftano di uno, così no c'è la location zero, e quindi non c'è nemmeno lo stato -0 che manda tutto in merda
	int Ppolice=1, Pthief=3;
	int ShasBaton=0;
	//Objective
	
	clock Creach;
	</declaration>
	 
	 
	 
	 
	automata_declaration
	state_updater
	<template>
	<name>states</name>
	<location id="base">
	<name>base</name>
	</location>
	<init ref = "base"/>	
	<transition>
	<source ref="base"/>
	<target ref="base"/>
	<label kind="synchronisation">pickUpBaton?</label>
	<label kind="assignment">ShasBaton=1</label>
	</transition>
	<transition>
	<source ref="base"/>
	<target ref="base"/>
	<label kind="synchronisation">putDownBaton?</label>
	<label kind="assignment">ShasBaton=0</label>
	</transition>
	</template>
	
	rules
agents
	<template>
	<name>police</name>
	 
	//no local declarations used
	 
	//LOCATIONS
	//nota: sto dando stesso ID a location su agneti diversi, spero non lo mandi a male
	//se lo user non definisce connesssioni tra tutte le location lui non smatta
<location id="a"> 
<name>a</name>
</location>
<location id="b"> 
<name>b</name>
</location>
<location id="c"> 
<name>c</name>
</location>
<location id="d"> 
<name>d</name>
</location>
<location id="weaponCloset"> 
<name>weaponCloset</name>
</location>
		
//transitional locations
<location id="going_a_to_b">
<name>going_a_to_b</name>
<label kind="invariant">Cpolice&lt;=11</label>
</location>
<location id="going_b_to_a"> 
<name>going_b_to_a</name>			
<label kind="invariant">Cpolice&lt;=11</label>
</location>
 
<location id="going_b_to_c">
<name>going_b_to_c</name>
<label kind="invariant">Cpolice&lt;=11</label>
</location>
<location id="going_c_to_b"> 
<name>going_c_to_b</name>			
<label kind="invariant">Cpolice&lt;=11</label>
</location>
 
<location id="going_c_to_d">
<name>going_c_to_d</name>
<label kind="invariant">Cpolice&lt;=11</label>
</location>
<location id="going_d_to_c"> 
<name>going_d_to_c</name>			
<label kind="invariant">Cpolice&lt;=11</label>
</location>
 
<location id="going_d_to_a">
<name>going_d_to_a</name>
<label kind="invariant">Cpolice&lt;=11</label>
</location>
<location id="going_a_to_d"> 
<name>going_a_to_d</name>			
<label kind="invariant">Cpolice&lt;=11</label>
</location>
 
<location id="going_weaponCloset_to_a">
<name>going_weaponCloset_to_a</name>
<label kind="invariant">Cpolice&lt;=4</label>
</location>
<location id="going_a_to_weaponCloset"> 
<name>going_a_to_weaponCloset</name>			
<label kind="invariant">Cpolice&lt;=4</label>
</location>
 
		
	//location for durable actions (just one if it's locations specic and/or the agent isn't mobile )
<location id = "doing_pickUpBaton_in_weaponCloset">
<name>doing_pickUpBaton_in_weaponCloset</name>
<label kind="invariant">Cpolice&lt;=6</label>
</location>
		
<location id = "doing_putDownBaton_in_weaponCloset">
<name>doing_putDownBaton_in_weaponCloset</name>
<label kind="invariant">Cpolice&lt;=6</label>
</location>
		
					
		
		
		
	//initial location id is passed
	<init ref = "a"/>	
	
	
	
	
	//transitions
	//movement transitions
<transition>
<source ref="a"/>
<target ref="going_a_to_b"/>
<label kind="synchronisation">police_a2b!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment">Ppolice = -12,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_a_to_b"/>
<target ref="b"/>
<label kind="guard">Cpolice &gt; 10</label>
<label kind="assignment">Ppolice = 2,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="b"/>
<target ref="going_b_to_a"/>
<label kind="synchronisation">police_b2a!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment"> Ppolice = -21,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_b_to_a"/>
<target ref="a"/>
<label kind="guard">Cpolice&gt;10</label>
<label kind="assignment">Ppolice = 1,  Cpolice= 0</label>
</transition>
<transition>
<source ref="b"/>
<target ref="going_b_to_c"/>
<label kind="synchronisation">police_b2c!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment">Ppolice = -23,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_b_to_c"/>
<target ref="c"/>
<label kind="guard">Cpolice &gt; 10</label>
<label kind="assignment">Ppolice = 3,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="c"/>
<target ref="going_c_to_b"/>
<label kind="synchronisation">police_c2b!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment"> Ppolice = -32,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_c_to_b"/>
<target ref="b"/>
<label kind="guard">Cpolice&gt;10</label>
<label kind="assignment">Ppolice = 2,  Cpolice= 0</label>
</transition>
<transition>
<source ref="c"/>
<target ref="going_c_to_d"/>
<label kind="synchronisation">police_c2d!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment">Ppolice = -34,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_c_to_d"/>
<target ref="d"/>
<label kind="guard">Cpolice &gt; 10</label>
<label kind="assignment">Ppolice = 4,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="d"/>
<target ref="going_d_to_c"/>
<label kind="synchronisation">police_d2c!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment"> Ppolice = -43,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_d_to_c"/>
<target ref="c"/>
<label kind="guard">Cpolice&gt;10</label>
<label kind="assignment">Ppolice = 3,  Cpolice= 0</label>
</transition>
<transition>
<source ref="d"/>
<target ref="going_d_to_a"/>
<label kind="synchronisation">police_d2a!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment">Ppolice = -41,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_d_to_a"/>
<target ref="a"/>
<label kind="guard">Cpolice &gt; 10</label>
<label kind="assignment">Ppolice = 1,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="a"/>
<target ref="going_a_to_d"/>
<label kind="synchronisation">police_a2d!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment"> Ppolice = -14,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_a_to_d"/>
<target ref="d"/>
<label kind="guard">Cpolice&gt;10</label>
<label kind="assignment">Ppolice = 4,  Cpolice= 0</label>
</transition>
<transition>
<source ref="weaponCloset"/>
<target ref="going_weaponCloset_to_a"/>
<label kind="synchronisation">police_weaponCloset2a!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment">Ppolice = -51,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_weaponCloset_to_a"/>
<target ref="a"/>
<label kind="guard">Cpolice &gt; 3</label>
<label kind="assignment">Ppolice = 1,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="a"/>
<target ref="going_a_to_weaponCloset"/>
<label kind="synchronisation">police_a2weaponCloset!</label>
<label kind="guard">Cpolice &gt; 1</label>
<label kind="assignment"> Ppolice = -15,  Cpolice= 0</label>
</transition>
 
<transition>
<source ref="going_a_to_weaponCloset"/>
<target ref="weaponCloset"/>
<label kind="guard">Cpolice&gt;3</label>
<label kind="assignment">Ppolice = 5,  Cpolice= 0</label>
</transition>
		
	//action transitions
	//BUG : if an action si collaborative but nobody can react to it, the action will be always allowed
	


<transition>
<source ref="a"/>
<target ref="a"/>
<label kind="synchronisation">catch!</label>
<label kind="assignment"> Cpolice =0 </label>
<label kind="guard">Cpolice &gt; 1 &amp;&amp; (Pthief==1)  &amp;&amp; ShasBaton==1</label>
</transition>
 

<transition>
<source ref="b"/>
<target ref="b"/>
<label kind="synchronisation">catch!</label>
<label kind="assignment"> Cpolice =0 </label>
<label kind="guard">Cpolice &gt; 1 &amp;&amp; (Pthief==2)  &amp;&amp; ShasBaton==1</label>
</transition>
 

<transition>
<source ref="c"/>
<target ref="c"/>
<label kind="synchronisation">catch!</label>
<label kind="assignment"> Cpolice =0 </label>
<label kind="guard">Cpolice &gt; 1 &amp;&amp; (Pthief==3)  &amp;&amp; ShasBaton==1</label>
</transition>
 

<transition>
<source ref="d"/>
<target ref="d"/>
<label kind="synchronisation">catch!</label>
<label kind="assignment"> Cpolice =0 </label>
<label kind="guard">Cpolice &gt; 1 &amp;&amp; (Pthief==4)  &amp;&amp; ShasBaton==1</label>
</transition>
 

<transition>
<source ref="weaponCloset"/>
<target ref="weaponCloset"/>
<label kind="synchronisation">catch!</label>
<label kind="assignment"> Cpolice =0 </label>
<label kind="guard">Cpolice &gt; 1 &amp;&amp; (Pthief==5)  &amp;&amp; ShasBaton==1</label>
</transition>
 
<transition>
<source ref="going_a_to_b"/>
<target ref="going_a_to_b"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-21)  &amp;&amp; ShasBaton==1</label>
</transition>

<transition>
<source ref="going_b_to_a"/>
<target ref="going_b_to_a"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-12)  &amp;&amp; ShasBaton==1</label>
</transition>
<transition>
<source ref="going_b_to_c"/>
<target ref="going_b_to_c"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-32)  &amp;&amp; ShasBaton==1</label>
</transition>

<transition>
<source ref="going_c_to_b"/>
<target ref="going_c_to_b"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-23)  &amp;&amp; ShasBaton==1</label>
</transition>
<transition>
<source ref="going_c_to_d"/>
<target ref="going_c_to_d"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-43)  &amp;&amp; ShasBaton==1</label>
</transition>

<transition>
<source ref="going_d_to_c"/>
<target ref="going_d_to_c"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-34)  &amp;&amp; ShasBaton==1</label>
</transition>
<transition>
<source ref="going_d_to_a"/>
<target ref="going_d_to_a"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-14)  &amp;&amp; ShasBaton==1</label>
</transition>

<transition>
<source ref="going_a_to_d"/>
<target ref="going_a_to_d"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-41)  &amp;&amp; ShasBaton==1</label>
</transition>
<transition>
<source ref="going_weaponCloset_to_a"/>
<target ref="going_weaponCloset_to_a"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-15)  &amp;&amp; ShasBaton==1</label>
</transition>

<transition>
<source ref="going_a_to_weaponCloset"/>
<target ref="going_a_to_weaponCloset"/>
<label kind="synchronisation">catch!</label>
<label kind="guard">Cpolice &gt; 0 &amp;&amp; (Pthief==-51)  &amp;&amp; ShasBaton==1</label>
</transition>
<transition>
<source ref="weaponCloset"/>
<target ref="doing_pickUpBaton_in_weaponCloset"/>
<label kind="synchronisation">pickUpBaton!</label>
<label kind="assignment"> Cpolice =0,Ppolice=-55 </label>
<label kind="guard">Cpolice &gt; 1  </label>
</transition>
 
<transition>
<source ref="doing_pickUpBaton_in_weaponCloset"/>
<target ref="weaponCloset"/>
<label kind="synchronisation">pickUpBatonDONE!</label>
<label kind="assignment"> Cpolice =0, Ppolice=5 </label>
<label kind="guard"> Cpolice &gt; 5 </label>
</transition>			
 

<transition>
<source ref="weaponCloset"/>
<target ref="doing_putDownBaton_in_weaponCloset"/>
<label kind="synchronisation">putDownBaton!</label>
<label kind="assignment"> Cpolice =0,Ppolice=-55 </label>
<label kind="guard">Cpolice &gt; 1  </label>
</transition>
 
<transition>
<source ref="doing_putDownBaton_in_weaponCloset"/>
<target ref="weaponCloset"/>
<label kind="synchronisation">putDownBatonDONE!</label>
<label kind="assignment"> Cpolice =0, Ppolice=5 </label>
<label kind="guard"> Cpolice &gt; 5 </label>
</transition>			
 

					
		
		
		
	</template>		
	 
		
	<template>
	<name>thief</name>
	 
	//no local declarations used
	 
	//LOCATIONS
	//nota: sto dando stesso ID a location su agneti diversi, spero non lo mandi a male
	//se lo user non definisce connesssioni tra tutte le location lui non smatta
<location id="a"> 
<name>a</name>
</location>
<location id="b"> 
<name>b</name>
</location>
<location id="c"> 
<name>c</name>
</location>
<location id="d"> 
<name>d</name>
</location>
<location id="weaponCloset"> 
<name>weaponCloset</name>
</location>
		
//transitional locations
<location id="going_a_to_b">
<name>going_a_to_b</name>
<label kind="invariant">Cthief&lt;=21</label>
</location>
<location id="going_b_to_a"> 
<name>going_b_to_a</name>			
<label kind="invariant">Cthief&lt;=21</label>
</location>
 
<location id="going_b_to_c">
<name>going_b_to_c</name>
<label kind="invariant">Cthief&lt;=21</label>
</location>
<location id="going_c_to_b"> 
<name>going_c_to_b</name>			
<label kind="invariant">Cthief&lt;=21</label>
</location>
 
<location id="going_c_to_d">
<name>going_c_to_d</name>
<label kind="invariant">Cthief&lt;=21</label>
</location>
<location id="going_d_to_c"> 
<name>going_d_to_c</name>			
<label kind="invariant">Cthief&lt;=21</label>
</location>
 
<location id="going_d_to_a">
<name>going_d_to_a</name>
<label kind="invariant">Cthief&lt;=21</label>
</location>
<location id="going_a_to_d"> 
<name>going_a_to_d</name>			
<label kind="invariant">Cthief&lt;=21</label>
</location>
 
<location id="going_weaponCloset_to_a">
<name>going_weaponCloset_to_a</name>
<label kind="invariant">Cthief&lt;=7</label>
</location>
<location id="going_a_to_weaponCloset"> 
<name>going_a_to_weaponCloset</name>			
<label kind="invariant">Cthief&lt;=7</label>
</location>
 
		
	//location for durable actions (just one if it's locations specic and/or the agent isn't mobile )
					
		
		
		
	//initial location id is passed
	<init ref = "c"/>	
	
	
	
	
	//transitions
	//movement transitions
<transition controllable="false" >
<source ref="a"/>
<target ref="going_a_to_b"/>
<label kind="synchronisation">thief_a2b!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment">Pthief = -12,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_a_to_b"/>
<target ref="b"/>
<label kind="guard">Cthief &gt; 20</label>
<label kind="assignment">Pthief = 2,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="b"/>
<target ref="going_b_to_a"/>
<label kind="synchronisation">thief_b2a!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment"> Pthief = -21,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_b_to_a"/>
<target ref="a"/>
<label kind="guard">Cthief&gt;20</label>
<label kind="assignment">Pthief = 1,  Cthief= 0</label>
</transition>
<transition controllable="false" >
<source ref="b"/>
<target ref="going_b_to_c"/>
<label kind="synchronisation">thief_b2c!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment">Pthief = -23,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_b_to_c"/>
<target ref="c"/>
<label kind="guard">Cthief &gt; 20</label>
<label kind="assignment">Pthief = 3,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="c"/>
<target ref="going_c_to_b"/>
<label kind="synchronisation">thief_c2b!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment"> Pthief = -32,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_c_to_b"/>
<target ref="b"/>
<label kind="guard">Cthief&gt;20</label>
<label kind="assignment">Pthief = 2,  Cthief= 0</label>
</transition>
<transition controllable="false" >
<source ref="c"/>
<target ref="going_c_to_d"/>
<label kind="synchronisation">thief_c2d!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment">Pthief = -34,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_c_to_d"/>
<target ref="d"/>
<label kind="guard">Cthief &gt; 20</label>
<label kind="assignment">Pthief = 4,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="d"/>
<target ref="going_d_to_c"/>
<label kind="synchronisation">thief_d2c!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment"> Pthief = -43,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_d_to_c"/>
<target ref="c"/>
<label kind="guard">Cthief&gt;20</label>
<label kind="assignment">Pthief = 3,  Cthief= 0</label>
</transition>
<transition controllable="false" >
<source ref="d"/>
<target ref="going_d_to_a"/>
<label kind="synchronisation">thief_d2a!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment">Pthief = -41,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_d_to_a"/>
<target ref="a"/>
<label kind="guard">Cthief &gt; 20</label>
<label kind="assignment">Pthief = 1,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="a"/>
<target ref="going_a_to_d"/>
<label kind="synchronisation">thief_a2d!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment"> Pthief = -14,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_a_to_d"/>
<target ref="d"/>
<label kind="guard">Cthief&gt;20</label>
<label kind="assignment">Pthief = 4,  Cthief= 0</label>
</transition>
<transition controllable="false" >
<source ref="weaponCloset"/>
<target ref="going_weaponCloset_to_a"/>
<label kind="synchronisation">thief_weaponCloset2a!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment">Pthief = -51,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_weaponCloset_to_a"/>
<target ref="a"/>
<label kind="guard">Cthief &gt; 6</label>
<label kind="assignment">Pthief = 1,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="a"/>
<target ref="going_a_to_weaponCloset"/>
<label kind="synchronisation">thief_a2weaponCloset!</label>
<label kind="guard">Cthief &gt; 1</label>
<label kind="assignment"> Pthief = -15,  Cthief= 0</label>
</transition>
 
<transition controllable="false" >
<source ref="going_a_to_weaponCloset"/>
<target ref="weaponCloset"/>
<label kind="guard">Cthief&gt;6</label>
<label kind="assignment">Pthief = 5,  Cthief= 0</label>
</transition>
		
	//action transitions
	//BUG : if an action si collaborative but nobody can react to it, the action will be always allowed
	
					
		
		
		
	</template>		
	 
		



	
objectives

<template>
<name>reachObj</name>
//locations

<location id = "initial_location">
<name>initial_location</name>
</location>
<location id = "unlocked">
</location>
<location id = "win">
<name>win</name>
</location>
 
<init ref = "initial_location"/>	
 
//transitions
<transition>
<source ref="initial_location"/>
<target ref="unlocked"/>
<label kind = "guard">Creach &gt; 0</label>
</transition>	

<transition>
<source ref="unlocked"/>
<target ref="win"/>
<label kind="synchronisation">catch?</label>
</transition>

</template>

	//in questo momento bugga se non ci sono regole
	<system>
	system  states, police, thief ,reachObj  ;
	
	
	
	</system>

	
	</nta>
